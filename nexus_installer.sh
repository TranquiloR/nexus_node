#!/bin/bash

# Nexus Prover Node Installation Script (Private Version)
# –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ prover node –¥–ª—è Nexus Network —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π node-id.
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É GitHub-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é.

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GOLD='\033[1;33m' # –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π —Ü–≤–µ—Ç –¥–ª—è —Ç–µ–∫—Å—Ç–∞
NC='\033[0m'      # –°–±—Ä–æ—Å —Ü–≤–µ—Ç–∞

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ ASCII-–∞—Ä—Ç–∞ "NEXUS NODE"
print_welcome() {
    clear
    echo -e "\033[40m\033[33m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïë ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó\033[0m"
    echo -e "\033[40m\033[33m‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó–°–°‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö–°–°‚ïó –°–°‚ïî‚ïù    –°–°–°–°‚ïó  –°–°‚ïë–°–°‚ïî‚ïê‚ïê‚ïê–°–°‚ïó–°–°‚ïî‚ïê‚ïê–°–°‚ïó–°–°‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù\033[0m"
    echo -e "\033[40m\033[33m‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù     –°–°‚ïî–°–°‚ïó –°–°‚ïë–°–°‚ïë   –°–°‚ïë–°–°‚ïë  –°–°‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  \033[0m"
    echo -e "\033[40m\033[33m–°–°‚ïî‚ïê‚ïê‚ïù  –°–°‚ïî‚ïê‚ïê–°–°‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê–°–°‚ïë  ‚ïö–°–°‚ïî‚ïù      –°–°‚ïë‚ïö–°–°‚ïó–°–°‚ïë–°–°‚ïë   –°–°‚ïë–°–°‚ïë  –°–°‚ïë–°–°‚ïî‚ïê‚ïê‚ïù  \033[0m"
    echo -e "\033[40m\033[33m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó–°–°‚ïë  –°–°‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë   –°–°‚ïë       –°–°‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó\033[0m"
    echo -e "\033[40m\033[33m‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù       ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\033[0m"
    echo ""
    echo "–ü—Ä–æ—Å—Ç–æ –æ —Å–ª–æ–∂–Ω—ã—Ö –Ω–æ–¥–∞—Ö (üí∏) ‚Äî –ü—Ä–∏–≤–∞—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è"
    sleep 2
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã
check_status() {
    if [ $? -ne 0 ]; then
        echo "–û—à–∏–±–∫–∞: $1"
        exit 1
    fi
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
install_dependencies() {
    echo "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è Nexus Prover Node..."
    sudo apt update
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É"
    sudo apt install -y curl git screen build-essential pkg-config libssl-dev psmisc
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Rust
    if ! command -v rustc &> /dev/null; then
        echo "Rust –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º..."
        curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Rust"
        source "$HOME/.cargo/env"
    fi
    rustup update
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å Rust"

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ø–æ–¥–∫–∞—á–∫–∏ (swap)
    echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π–ª–∞ –ø–æ–¥–∫–∞—á–∫–∏ (swap)..."
    if ! swapon --show | grep -q "/swapfile"; then
        echo "–°–æ–∑–¥–∞–µ–º swap-—Ñ–∞–π–ª —Ä–∞–∑–º–µ—Ä–æ–º 8 –ì–ë..."
        sudo fallocate -l 8G /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–¥–µ–ª–∏—Ç—å –º–µ—Å—Ç–æ –¥–ª—è swap-—Ñ–∞–π–ª–∞"
        sudo chmod 600 /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ swap-—Ñ–∞–π–ª"
        sudo mkswap /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å swap-—Ñ–∞–π–ª"
        sudo swapon /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å swap-—Ñ–∞–π–ª"
        if ! grep -q "/swapfile" /etc/fstab; then
            echo "/swapfile none swap sw 0 0" | sudo tee -a /etc/fstab
            check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å swap –≤ /etc/fstab"
        fi
        echo "Swap-—Ñ–∞–π–ª —Ä–∞–∑–º–µ—Ä–æ–º 8 –ì–ë —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω."
    else
        echo "Swap-—Ñ–∞–π–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ."
    fi

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    for cmd in pkg-config screen git curl rustc; do
        if ! command -v "$cmd" &> /dev/null; then
            echo "–û—à–∏–±–∫–∞: $cmd –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ—Å–ª–µ –ø–æ–ø—ã—Ç–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏."
            exit 1
        fi
    done
    echo "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ swap-—Ñ–∞–π–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã."
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ Nexus Network
install_project() {
    echo "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ Nexus Network..."
    local project_dir="/root/.nexus/network_api"
    
    if [ -d "$project_dir" ]; then
        if [ -d "$project_dir/.git" ]; then
            echo "–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –û–±–Ω–æ–≤–ª—è–µ–º —Å –ø–æ–º–æ—â—å—é git pull..."
            cd "$project_dir"
            git pull
            check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
        else
            echo "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º. –£–¥–∞–ª—è–µ–º –∏ –∫–ª–æ–Ω–∏—Ä—É–µ–º –∑–∞–Ω–æ–≤–æ..."
            sudo rm -rf "$project_dir"
            check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é"
            mkdir -p "$project_dir"
            cd "$project_dir"
            git clone https://github.com/nexus-xyz/network-api.git .
            check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
        fi
    else
        echo "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π..."
        mkdir -p "$project_dir"
        cd "$project_dir"
        git clone https://github.com/nexus-xyz/network-api.git .
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
    fi
    
    # –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ release
    cd "$project_dir/clients/cli"
    cargo build --release
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç"
    echo "–ü—Ä–æ–µ–∫—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω."
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–æ–¥—ã
start_node() {
    echo "–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ screen –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –Ω–æ–¥—ã..."
    
    # –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–π —Å–µ—Å—Å–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    if screen -list | grep -q "nexus_node"; then
        echo "–ó–∞–∫—Ä—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é screen 'nexus_node'..."
        screen -X -S nexus_node quit
        sleep 2  # –ö–æ—Ä–æ—Ç–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
    fi
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ screen —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º –±—É—Ñ–µ—Ä–æ–º
    screen -h 5000 -dmS nexus_node
    sleep 5  # –ó–∞–¥–µ—Ä–∂–∫–∞, —á—Ç–æ–±—ã —Å–µ—Å—Å–∏—è —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∞—Å—å
    if ! screen -list | grep -q "nexus_node"; then
        echo "–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é screen."
        exit 1
    else
        echo "–°–µ—Å—Å–∏—è screen 'nexus_node' —Å–æ–∑–¥–∞–Ω–∞. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 —Å–µ–∫—É–Ω–¥, –∑–∞—Ç–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —á–µ—Ä–µ–∑ –æ–ø—Ü–∏—é 4 –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:"
        echo "–í—ã–¥–µ–ª–∏—Ç–µ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∏–∂–µ, –∑–∞—Ç–µ–º –≤—Å—Ç–∞–≤—å—Ç–µ –∏—Ö –≤ —Å–µ—Å—Å–∏—é screen (–Ω–∞–∂–º–∏—Ç–µ Ctrl+Shift+V –∏–ª–∏ –ø—Ä–∞–≤—É—é –∫–Ω–æ–ø–∫—É –º—ã—à–∏):"
        echo "cd /root/.nexus/network_api/clients/cli"
        echo "source /root/.cargo/env"
        echo "cargo run --release -- start --env beta"
        echo "–ó–∞—Ç–µ–º –≤–≤–µ–¥–∏—Ç–µ '2' –∏ –≤–∞—à node-id (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'dEfAuLT1') –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è."
        echo "–õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Å–µ—Å—Å–∏–∏ screen. –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–≤–æ–¥ –≤ /tmp/nexus_node.log, –∑–∞–ø—É—Å—Ç–∏–≤:"
        echo "cargo run --release -- start --env beta > /tmp/nexus_node.log 2>&1"
        echo "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø—Ü–∏—é 4 –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞."
        echo "–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π GitHub-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π."
    fi
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–æ–¥–µ
node_info() {
    echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –Ω–æ–¥—ã..."
    if screen -list | grep -q "nexus_node"; then
        echo "–ù–æ–¥–∞ –∑–∞–ø—É—â–µ–Ω–∞. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —Å –ø–æ–º–æ—â—å—é –æ–ø—Ü–∏–∏ 4 –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤."
        screen_pid=$(screen -ls | grep nexus_node | awk '{print $1}' | sed 's/\.//')
        if [ -n "$screen_pid" ]; then
            echo "PID —Å–µ—Å—Å–∏–∏ screen: $screen_pid"
            pstree -p "$screen_pid" | grep nexus-network >/dev/null 2>&1
            if [ $? -eq 0 ]; then
                echo "–ü—Ä–æ—Ü–µ—Å—Å nexus-network –ø—Ä–∏–≤—è–∑–∞–Ω –∫ screen."
            else
                echo "–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ø—Ä–æ—Ü–µ—Å—Å nexus-network –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–µ—Å—Å–∏–∏ screen. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ 'ps aux | grep nexus-network'."
            fi
        fi
    else
        echo "–ù–æ–¥–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞."
    fi
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–æ–¥—ã
remove_node() {
    echo "–£–¥–∞–ª–µ–Ω–∏–µ –Ω–æ–¥—ã –∏ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö..."
    if screen -list | grep -q "nexus_node"; then
        echo "–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ—Å—Å–∏—é screen 'nexus_node'..."
        screen -S nexus_node -X quit
    fi
    sudo rm -rf /root/.nexus/network_api
    sudo rm -rf /root/.nexus
    sudo rm -f /swapfile
    if grep -q "/swapfile" /etc/fstab; then
        sudo sed -i '/\/swapfile/d' /etc/fstab
    fi
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, swap-—Ñ–∞–π–ª –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
    echo "–ù–æ–¥–∞, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ swap-—Ñ–∞–π–ª —É–¥–∞–ª–µ–Ω—ã."
}

# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–æ–¥—ã
install_node() {
    install_dependencies
    install_project
}

# –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —Å –º–µ–Ω—é
print_welcome
while true; do
    echo ""
    echo -e "${GOLD}=== –ú–µ–Ω—é —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ Nexus Prover Node ===${NC}"
    echo "1) üöÄ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–¥—É (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, swap, –ø—Ä–æ–µ–∫—Ç)"
    echo "2) ‚ñ∂ –°–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é screen –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –Ω–æ–¥—ã"
    echo "3) üìú –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–æ–¥—ã"
    echo "4) üîç –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Å—Å–∏–∏ screen –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤"
    echo "5) ‚èè –í—ã–π—Ç–∏ –∏–∑ —Å–µ—Å—Å–∏–∏ screen, –æ—Å—Ç–∞–≤–∏–≤ –Ω–æ–¥—É —Ä–∞–±–æ—Ç–∞—Ç—å"
    echo "6) üóë –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å –Ω–æ–¥—É –∏ –¥–∞–Ω–Ω—ã–µ"
    echo "7) ‚ùå –í—ã–π—Ç–∏ –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞"
    read -p "–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é: " choice
    echo ""

    case $choice in
        1)
            install_node
            ;;
        2)
            start_node
            ;;
        3)
            node_info
            ;;
        4)
            echo "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Å—Å–∏–∏ screen –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤..."
            echo "–î–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–µ—Å—Å–∏–∏ –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ Ctrl+A D."
            read -p "–ù–∞–∂–º–∏—Ç–µ Enter, —á—Ç–æ–±—ã –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Å—Å–∏–∏ screen..." -n 1 -s
            screen -r nexus_node
            ;;
        5)
            echo "–û—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç —Å–µ—Å—Å–∏–∏ screen, –Ω–æ–¥–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ..."
            screen -d nexus_node
            echo "–°–µ—Å—Å–∏—è –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∞. –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥—É—é –æ–ø—Ü–∏—é."
            ;;
        6)
            remove_node
            ;;
        7)
            echo "–í—ã—Ö–æ–¥ –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞. –î–æ –≤—Å—Ç—Ä–µ—á–∏!"
            exit 0
            ;;
        *)
            echo "–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 7."
            ;;
    esac
done
