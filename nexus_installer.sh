#!/bin/bash

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GOLD='\033[1;33m' # –ó–æ–ª–æ—Ç–∏—Å—Ç—ã–π —Ü–≤–µ—Ç –¥–ª—è —Ç–µ–∫—Å—Ç–∞
NC='\033[0m'      # –°–±—Ä–æ—Å —Ü–≤–µ—Ç–∞

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ ASCII-–∞—Ä—Ç–∞ "NEXUS NODE"
print_welcome() {
    clear
    echo -e "\033[40m\033[33m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïë ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó\033[0m"
    echo -e "\033[40m\033[33m‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó–°–°‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö–°–°‚ïó –°–°‚ïî‚ïù    –°–°–°–°‚ïó  –°–°‚ïë–°–°‚ïî‚ïê‚ïê‚ïê–°–°‚ïó–°–°‚ïî‚ïê‚ïê–°–°‚ïó–°–°‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù\033[0m"
    echo -e "\033[40m\033[33m‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù     –°–°‚ïî–°–°‚ïó –°–°‚ïë–°–°‚ïë   –°–°‚ïë–°–°‚ïë  –°–°‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  \033[0m"
    echo -e "\033[40m\033[33m–°–°‚ïî‚ïê‚ïê‚ïù  –°–°‚ïî‚ïê‚ïê–°–°‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê–°–°‚ïë  ‚ïö–°–°‚ïî‚ïù      –°–°‚ïë‚ïö–°–°‚ïó–°–°‚ïë–°–°‚ïë   –°–°‚ïë–°–°‚ïë  –°–°‚ïë–°–°‚ïî‚ïê‚ïê‚ïù  \033[0m"
    echo -e "\033[40m\033[33m‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó–°–°‚ïë  –°–°‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë   –°–°‚ïë       –°–°‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó\033[0m"
    echo -e "\033[40m\033[33m‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù       ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\033[0m"
    echo ""
    echo "–ü—Ä–æ—Å—Ç–æ –æ —Å–ª–æ–∂–Ω—ã—Ö –Ω–æ–¥–∞—Ö (üí∏) ‚Äî –õ—É—á—à–∞—è –≤–µ—Ä—Å–∏—è"
    sleep 2
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã
check_status() {
    if [ $? -ne 0 ]; then
        echo "–û—à–∏–±–∫–∞: $1"
        exit 1
    fi
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
install_dependencies() {
    echo "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è Nexus Prover Node..."
    
    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
    sudo DEBIAN_FRONTEND=noninteractive apt update -y
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ needrestart
    if ! command -v needrestart &> /dev/null; then
        echo "–£—Ç–∏–ª–∏—Ç–∞ needrestart –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º..."
        sudo DEBIAN_FRONTEND=noninteractive apt install -y needrestart
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å needrestart"
    else
        echo "–£—Ç–∏–ª–∏—Ç–∞ needrestart —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞."
    fi
    
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
    sudo DEBIAN_FRONTEND=noninteractive apt install -y curl git screen build-essential pkg-config libssl-dev psmisc
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã"
    
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Rust, –µ—Å–ª–∏ –æ–Ω –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
    if ! command -v rustc &> /dev/null; then
        echo "Rust –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º..."
        curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Rust"
        source "$HOME/.cargo/env"
    fi
    rustup update
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å Rust"
    
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
    echo "–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏..."
    sudo needrestart -r a
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤"
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ swap-—Ñ–∞–π–ª–∞
    echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π–ª–∞ –ø–æ–¥–∫–∞—á–∫–∏ (swap)..."
    if ! swapon --show | grep -q "/swapfile"; then
        echo "–°–æ–∑–¥–∞–µ–º swap-—Ñ–∞–π–ª —Ä–∞–∑–º–µ—Ä–æ–º 8 –ì–ë..."
        sudo fallocate -l 8G /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–¥–µ–ª–∏—Ç—å –º–µ—Å—Ç–æ –¥–ª—è swap-—Ñ–∞–π–ª–∞"
        sudo chmod 600 /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ swap-—Ñ–∞–π–ª"
        sudo mkswap /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å swap-—Ñ–∞–π–ª"
        sudo swapon /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å swap-—Ñ–∞–π–ª"
        if ! grep -q "/swapfile" /etc/fstab; then
            echo "/swapfile none swap sw 0 0" | sudo tee -a /etc/fstab
            check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å swap –≤ /etc/fstab"
        fi
        echo "Swap-—Ñ–∞–π–ª —Ä–∞–∑–º–µ—Ä–æ–º 8 –ì–ë —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω."
    else
        echo "Swap-—Ñ–∞–π–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ."
    fi
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    for cmd in pkg-config screen git curl rustc needrestart; do
        if ! command -v "$cmd" &> /dev/null; then
            echo "–û—à–∏–±–∫–∞: $cmd –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ—Å–ª–µ –ø–æ–ø—ã—Ç–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏."
            exit 1
        fi
    done
    echo "–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ swap-—Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã."
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ Nexus Network
install_project() {
    echo "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ Nexus Network..."
    local project_dir="/root/.nexus/network_api"
    
    if [ -d "$project_dir" ]; then
        if [ -d "$project_dir/.git" ]; then
            echo "–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –û–±–Ω–æ–≤–ª—è–µ–º —Å –ø–æ–º–æ—â—å—é git pull..."
            cd "$project_dir"
            git pull
            check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
        else
            echo "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º. –£–¥–∞–ª—è–µ–º –∏ –∫–ª–æ–Ω–∏—Ä—É–µ–º –∑–∞–Ω–æ–≤–æ..."
            sudo rm -rf "$project_dir"
            check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é"
            mkdir -p "$project_dir"
            cd "$project_dir"
            git clone https://github.com/nexus-xyz/network-api.git .
            check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
        fi
    else
        echo "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π..."
        mkdir -p "$project_dir"
        cd "$project_dir"
        git clone https://github.com/nexus-xyz/network-api.git .
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
    fi
    
    # –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
    cd "$project_dir/clients/cli"
    cargo build --release
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç"
    echo "–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω."
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–æ–¥—ã
start_node() {
    echo "–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ screen –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–æ–¥—ã..."
    
    # –ó–∞–ø—Ä–æ—Å node ID
    read -p "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à node ID (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'dEfAuLT1'): " node_id
    if [ -z "$node_id" ]; then
        echo "–û—à–∏–±–∫–∞: node ID –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º."
        exit 1
    fi
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ node ID –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    mkdir -p /root/.nexus
    echo "$node_id" > /root/.nexus/node-id
    check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å node ID –≤ /root/.nexus/node-id"
    echo "node ID —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ /root/.nexus/node-id"
    
    # –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–π —Å–µ—Å—Å–∏–∏ screen
    if screen -list | grep -q "nexus_node"; then
        echo "–ó–∞–∫—Ä—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é screen 'nexus_node'..."
        screen -X -S nexus_node quit
        sleep 2
    fi
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ screen —Å –Ω–µ–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º
    screen -h 5000 -dmS nexus_node bash -c "cd /root/.nexus/network_api/clients/cli && source /root/.cargo/env && NONINTERACTIVE=1 cargo run --release -- start --env beta"
    sleep 5
    if ! screen -list | grep -q "nexus_node"; then
        echo "–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é screen."
        exit 1
    else
        echo "–ù–æ–¥–∞ –∑–∞–ø—É—â–µ–Ω–∞ –≤ —Å–µ—Å—Å–∏–∏ screen 'nexus_node'. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —á–µ—Ä–µ–∑ –æ–ø—Ü–∏—é 3 –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤."
    fi
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –Ω–æ–¥—ã
node_info() {
    echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –Ω–æ–¥—ã..."
    if screen -list | grep -q "nexus_node"; then
        echo "–ù–æ–¥–∞ –∑–∞–ø—É—â–µ–Ω–∞. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —Å –ø–æ–º–æ—â—å—é –æ–ø—Ü–∏–∏ 3 –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤."
    else
        echo "–ù–æ–¥–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞."
    fi
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–æ–¥—ã
remove_node() {
    echo "–£–¥–∞–ª–µ–Ω–∏–µ –Ω–æ–¥—ã –∏ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö..."
    
    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Å—Å–∏–∏ screen, –µ—Å–ª–∏ –æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞
    if screen -list | grep -q "nexus_node"; then
        echo "–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ—Å—Å–∏—é screen 'nexus_node'..."
        screen -S nexus_node -X quit
        sleep 2
    fi
    
    # –£–¥–∞–ª–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –Ω–æ–¥—ã
    sudo rm -rf /root/.nexus/network_api
    sudo rm -rf /root/.nexus
    
    # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ swap-—Ñ–∞–π–ª–∞
    if swapon --show | grep -q "/swapfile"; then
        echo "–û—Ç–∫–ª—é—á–∞–µ–º swap-—Ñ–∞–π–ª..."
        sudo swapoff /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫–ª—é—á–∏—Ç—å swap-—Ñ–∞–π–ª"
    fi
    if [ -f "/swapfile" ]; then
        echo "–£–¥–∞–ª—è–µ–º swap-—Ñ–∞–π–ª..."
        sudo rm -f /swapfile
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å swap-—Ñ–∞–π–ª"
    fi
    
    # –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ swap –∏–∑ /etc/fstab
    if grep -q "/swapfile" /etc/fstab; then
        echo "–£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å—å –æ swap-—Ñ–∞–π–ª–µ –∏–∑ /etc/fstab..."
        sudo sed -i '/\/swapfile/d' /etc/fstab
        check_status "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å /etc/fstab"
    fi
    
    echo "–ù–æ–¥–∞ –∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã."
}

# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
install_node() {
    install_dependencies
    install_project
}

# –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –º–µ–Ω—é
print_welcome
echo -e "${GOLD}–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç 1 –∏ –Ω–∞–∂–º–∏—Ç–µ Enter${NC}"
while true; do
    echo ""
    echo -e "${GOLD}=== –ú–µ–Ω—é —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ Nexus Prover Node ===${NC}"
    echo "1) üöÄ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–¥—É (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, swap, –ø—Ä–æ–µ–∫—Ç)"
    echo "2) ‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–¥—É —Å –≤–∞—à–∏–º node ID"
    echo "3) üîç –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Å—Å–∏–∏ screen –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤"
    echo "4) üìú –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–æ–¥—ã"
    echo "5) ‚èè –í—ã–π—Ç–∏ –∏–∑ —Å–µ—Å—Å–∏–∏ screen, –æ—Å—Ç–∞–≤–∏–≤ –Ω–æ–¥—É —Ä–∞–±–æ—Ç–∞—Ç—å"
    echo "6) ‚ùå –í—ã–π—Ç–∏ –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞"
    echo "7) üóë –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å –Ω–æ–¥—É –∏ –¥–∞–Ω–Ω—ã–µ"
    read -p "–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é: " choice
    echo ""
    
    case $choice in
        1)
            install_node
            ;;
        2)
            start_node
            ;;
        3)
            echo "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Å—Å–∏–∏ screen. –î–ª—è –≤—ã—Ö–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ Ctrl+A D."
            read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è..." -n 1 -s
            screen -r nexus_node
            ;;
        4)
            node_info
            ;;
        5)
            echo "–û—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç —Å–µ—Å—Å–∏–∏ screen..."
            screen -d nexus_node
            echo "–°–µ—Å—Å–∏—è –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∞."
            ;;
        6)
            echo "–í—ã—Ö–æ–¥ –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞."
            exit 0
            ;;
        7)
            remove_node
            ;;
        *)
            echo "–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 7."
            ;;
    esac
done
